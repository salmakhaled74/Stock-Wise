<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Data</title>
  <link rel="stylesheet" href="/public/styles2.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
</head>

<body>

  <canvas id="line-chart"></canvas>
  <h1>
    <%= data[0].symbol %>
  </h1>
  <h1>
    <%= data[0].gainer.companyName %>
  </h1>
  <% for (let i=0; i < data.length; i++) { %>
    <h2>
      <%= data[i].close %>
    </h2>
    <h3>
      <%= data[i].priceDate.toLocaleDateString('en-GB') %>
    </h3>
    <% } %>

      <script>
        // get the data variable passed from the server-side
        const data = <%= JSON.stringify(data) %>;

        // use the data variable to create a chart using Chart.js
        const chartData = {
          labels: data.map(d => d.priceDate),
          datasets: [{
            label: 'Closing Price',
            data: data.map(d => d.close),
            borderColor: 'blue',
            fill: false
          }]
        };

        // create a new chart
        const ctx = document.getElementById('myChart').getContext('2d');
        new Chart(ctx, {
          type: 'line',
          data: chartData,
          options: {
            responsive: true,
            scales: {
              xAxes: [{
                type: 'time',
                time: {
                  unit: 'day',
                  displayFormats: {
                    day: 'MMM D'
                  }
                },
                ticks: {
                  maxTicksLimit: 10
                }
              }],
              yAxes: [{
                ticks: {
                  beginAtZero: true
                }
              }]
            }
          }
        });
      </script>

      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe"
        crossorigin="anonymous"></script>
      <script src="/public/apps.js"></script>
      <script src="https://kit.fontawesome.com/3c14fe92a8.js" crossorigin="anonymous"></script>
</body>

</html>